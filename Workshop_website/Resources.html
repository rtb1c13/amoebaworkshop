<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage"><head><script src="Resources_files/analytics.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app215.us.archive.org';v.server_ms=665;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="Resources_files/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="Resources_files/wombat.js" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="Resources_files/ruffle.js"></script><script src="Resources_files/page-script.js" id="bw-fido2-page-script"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("https://sites.google.com/site/amoebaworkshop/exercise-3","20210125225206","https://web.archive.org/","web","https://web-static.archive.org/_static/",
	      "1611615126");
</script>
<link rel="stylesheet" type="text/css" href="Resources_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="Resources_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->

<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { /*

Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/
(function(){function e(g){this.t={};this.tick=function(h,k,f){this.t[h]=[void 0!=f?f:(new Date).getTime(),k];if(void 0==f)try{window.console.timeStamp("CSI/"+h)}catch(m){}};this.getStartTickTime=function(){return this.t.start[0]};this.tick("start",null,g)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var l=0<d?new e(d):new e;window.jstiming={Timer:e,load:l};if(a){var b=a.navigationStart;0<b&&d>=b&&(window.jstiming.srt=d-b)}if(a){var c=window.jstiming.load;0<b&&d>=
b&&(c.tick("_wtsrt",void 0,b),c.tick("wtsrt_","_wtsrt",d),c.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),c&&0<b&&(c.tick("_tbnd",void 0,window.chrome.csi().startE),c.tick("tbnd_","_tbnd",b))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,c&&0<b&&(c.tick("_tbnd",void 0,window.external.startE),c.tick("tbnd_","_tbnd",b))),a&&(window.jstiming.pt=a)}catch(g){}})(); })()
</script>
<link rel="shortcut icon" type="image/x-icon" href="https://web.archive.org/web/20210125225206im_/https://www.google.com/images/icons/product/sites-16.ico">
<link rel="apple-touch-icon" href="https://web.archive.org/web/20210125225206im_/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/images/apple-touch-icon.png" type="image/png">
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { function d(a){return document.getElementById(a)}window.byId=d;function g(a){return a.replace(/^\s+|\s+$/g,"")}window.trim=g;var h=[],k=0;window.JOT_addListener=function(a,b,c){var f=new String(k++);a={eventName:a,handler:b,compId:c,key:f};h.push(a);return f};window.JOT_removeListenerByKey=function(a){for(var b=0;b<h.length;b++)if(h[b].key==a){h.splice(b,1);break}};window.JOT_removeAllListenersForName=function(a){for(var b=0;b<h.length;b++)h[b].eventName==a&&h.splice(b,1)};
window.JOT_postEvent=function(a,b,c){var f={eventName:a,eventSrc:b||{},payload:c||{}};if(window.JOT_fullyLoaded)for(b=h.length,c=0;c<b&&c<h.length;c++){var e=h[c];e&&e.eventName==a&&(f.listenerCompId=e.compId||"",(e="function"==typeof e.handler?e.handler:window[e.handler])&&e(f))}else window.JOT_delayedEvents.push({eventName:a,eventSrc:b,payload:c})};window.JOT_delayedEvents=[];window.JOT_fullyLoaded=!1;
window.JOT_formatRelativeToNow=function(a,b){a=((new Date).getTime()-a)/6E4;if(1440<=a||0>a)return null;var c=0;60<=a&&(a/=60,c=2);2<=a&&c++;return b?window.JOT_siteRelTimeStrs[c].replace("__duration__",Math.floor(a)):window.JOT_userRelTimeStrs[c].replace("__duration__",Math.floor(a))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/site/amoebaworkshop/exercise-3","deleted":false,"title":"Exercise 3 - Analysing trajectories and calculating free energies","dir":"ltr"}];
  var JOT_clearDotPath = 'https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"gvizGstaticVersion":"current","enableAnalytics":false,"pageSharingId":"jotspot_page","codeembeds":{"outerIframeSrc":"https://web.archive.org/web/20210125225206/https://www.gstatic.com/jotspot/embeds/code/0f08d42392f2000e7e3f3daf5b427a43/outer_iframe.html","innerIframeSrc":"https://web.archive.org/web/20210125225206/https://1042130788-jotspot-embeds.googleusercontent.com/code/8d87fa64604b2a11fae2ed06104c58d3/inner_iframe.html"},"enableUniversalAnalytics":false,"sharingPolicy":"OPENED","siteTitle":"AMOEBA advanced potential energies workshop","jot2atari":{"eligibility":"ineligible"},"onepickUrl":"https://web.archive.org/web/20210125225206/https://docs.google.com/picker","adsensePublisherId":null,"features":{"moreMobileStyleImprovements":null,"subscriptionDataMigrationInProgress":null,"plusBadge":false},"isPublic":true,"newSitesBaseUrl":"https://web.archive.org/web/20210125225206/https://sites.google.com","isConsumer":true,"serverFlags":{"jot2AtariLearnMoreUrl":"https://web.archive.org/web/20210125225206/https://support.google.com/sites/answer/7035197"},"domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://web.archive.org/web/20210125225206/https://accounts.google.com/AccountChooser?continue\u003dhttps://sites.google.com/site/amoebaworkshop/exercise-3\u0026service\u003djotspot","analyticsAccountId":"","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://web.archive.org/web/20210125225206/https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//web.archive.org/web/20210125225206/https://www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/css/sitelayouteditor.css"],"text":["https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/js/codemirror.js","https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/css/codemirror_css.css","https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/js/trog_edit__en.js","https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/css/trogedit.css","/site/amoebaworkshop/_/rsrc/1610612676000/system/app/css/editor.css","https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/css/codeeditor.css","/site/amoebaworkshop/_/rsrc/1610612676000/system/app/css/camelot/editor-jfk.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"defaultdomain","baseUri":"/site/amoebaworkshop","name":"amoebaworkshop","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":null,"parentWuid":null,"siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Exercise 3 - Analysing trajectories and calculating free energies","locale":"en","wuid":"wuid:gx:6bf20198ee7a45b8","revision":16,"path":"/exercise-3","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"exercise-3","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","onePickToken":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/site/amoebaworkshop/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Exercise 3 - Analysing trajectories and calculating free energies - AMOEBA advanced potential energies workshop">
<meta itemprop="name" content="Exercise 3 - Analysing trajectories and calculating free energies - AMOEBA advanced potential energies workshop">
<meta property="og:title" content="Exercise 3 - Analysing trajectories and calculating free energies - AMOEBA advanced potential energies workshop">
<meta name="description" content="Instructions and activities for the AMOEBA advanced potentials workshop, Southampton, Dec 2016">
<meta itemprop="description" content="Instructions and activities for the AMOEBA advanced potentials workshop, Southampton, Dec 2016">
<meta id="meta-tag-description" property="og:description" content="Instructions and activities for the AMOEBA advanced potentials workshop, Southampton, Dec 2016">
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="Resources_files/standard-css-simple-ltr-ltr.css">
<link rel="stylesheet" type="text/css" href="Resources_files/overlay.css">
<link rel="stylesheet" type="text/css" href="Resources_files/allthemes-view.css">
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/site/amoebaworkshop/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Exercise 3 - Analysing trajectories and calculating free energies - AMOEBA advanced potential energies workshop</title>
<meta itemprop="image" content="https://web.archive.org/web/20210125225206im_/https://sites.google.com/site/amoebaworkshop/_/rsrc/1480506776669/exercise-3/Free_energy_eqns.png?height=216&amp;width=320">
<meta property="og:image" content="https://web.archive.org/web/20210125225206im_/https://sites.google.com/site/amoebaworkshop/_/rsrc/1480506776669/exercise-3/Free_energy_eqns.png?height=216&amp;width=320">
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
<script type="text/javascript" charset="UTF-8" src="Resources_files/platform.js"></script><script src="Resources_files/ga.js"></script></head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            "><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;">
</div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20210125225206/https://sites.google.com/site/amoebaworkshop/exercise-3</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(725,27,25,2,"web","https://sites.google.com/site/amoebaworkshop/exercise-3","20210125225206",1996,"https://web-static.archive.org/_static/",["https://web-static.archive.org/_static/css/banner-styles.css?v=S1zqJCYt","https://web-static.archive.org/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="">
<tbody><tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><h2><a href="./Home.html" dir="ltr" id="sites-chrome-userheader-title">AMOEBA advanced potential energies workshop</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/web/20210125225206/https://sites.google.com/site/amoebaworkshop/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site"><input type="text" id="jot-ui-searchInput" name="q" size="20" aria-label="Search this site"><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0" style="user-select: none;">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</tbody></table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tbody><tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2bd" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Navigation</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotid="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="./Home.html" jotid="wuid:gx:2433b5dc13050779" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://web.archive.org/web/20210125225206/https://sites.google.com/site/amoebaworkshop/intro" jotid="wuid:gx:1fd6c32ac2b1a6fe" class="sites-navigation-link">Intro &amp; setup</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="./Exercise 1.html" jotid="wuid:gx:45351533ca1c2014" class="sites-navigation-link">Exercise 1 - Getting started with Tinker</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://web.archive.org/web/20210125225206/https://sites.google.com./Exercise 2 part 1.html" jotid="wuid:gx:bd56be6b29c141c" class="sites-navigation-link">Exercise 2 part 1 - Parameterising a new molecule (electrostatics)</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://web.archive.org/web/20210125225206/https://sites.google.com./Exercise 2 part 1.html-part-2" jotid="wuid:gx:13ed29ff4d31ec95" class="sites-navigation-link">Exercise 2 part 2 - Parameterising a new molecule (valence &amp; vdW)</a></div></li><li class=""><div class="current-bg" jotid="wuid:gx:6bf20198ee7a45b8" dir="ltr" style="padding-left: 5px;">Exercise 3 - Analysing trajectories and calculating free energies</div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="./Sitemap.html" jotid="wuid:gx:66aafe7b737940d1" class="sites-navigation-link">Sitemap</a></div></li></ul></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
</div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Exercise 3 - Analysing trajectories and calculating free energies</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Analyses-in-Tinker"><strong>1 </strong>Analyses in Tinker</a></li><li class="goog-toc"><a href="#TOC-Analysing-with-analyze"><strong>2 </strong>Analysing with analyze</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Analysing-energetics"><strong>2.1 </strong>Analysing energetics</a></li><li class="goog-toc"><a href="#TOC-Parameter-scaling-with-lambda"><strong>2.2 </strong>Parameter scaling with lambda</a></li></ol></li><li class="goog-toc"><a href="#TOC-BAR-free-energy-estimates"><strong>3 </strong>BAR free energy estimates</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Between-lambda-windows"><strong>3.1 </strong>Between lambda windows</a></li><li class="goog-toc"><a href="#TOC-Overall-hydration-free-energy"><strong>3.2 </strong>Overall hydration free energy</a></li></ol></li></ol></div></div></div></div></div>
<h2><a name="TOC-Analyses-in-Tinker"></a>Analyses in Tinker</h2>
<p>As with the setup and dynamics tools, Tinker comes packaged with a 
variety of programs to perform specific analyses of generated structures
 or trajectories. These range from performing molecular superpositions 
&amp; calculating RMSDs (<code>superpose</code>), to calculating radial distribution functions (<code>radial</code>), to calculating a power spectrum for a system from the velocity autocorrelation function (<code>spectrum</code>). Many analyses can be performed using the <code>analyze</code>
 program, which includes ways to evaluate both properties of the system 
coordinates/energies, and the system parameters (e.g. printing out a 
breakdown of potential energy by individual components for specified 
atoms, evaluating overall molecular dipole moments, calculating radius 
of gyration etc.). We'll demonstrate a couple in this exercise, and feel
 free to investigate more if there's time.</p>
<p>The main analysis we're interested in for our free energy 
calculations is the calculation of free energy differences between the 
adjacent lambda windows. This makes use of the Tinker <code>bar</code> 
program and will calculate both standard FEP and BAR free energies 
between any two trajectories and any two key files/parameter sets. More 
on that later - first, let's check our simulations have worked.<br>
</p>
<hr>
<h2><a name="TOC-Analysing-with-analyze"></a>Analysing with <code>analyze</code></h2>
<h4><a name="TOC-Analysing-energetics"></a><span style="color:rgb(0,0,255)">Analysing energetics<br>
</span></h4>
<p>Log back into Lyceum (if you haven't done so already) and change into the directory for <code>Exercise_3</code>.
 Inside we've provided an example set of trajectories, in both solution 
phase and gas phase, that were run using the inputs generated in <a href="https://web.archive.org/web/20210125225206/https://sites.google.com./Exercise 2 part 1.html-part-2">exercise 2</a>. Each individual simulation at each lambda window is available in subdirectories within the <code>solution</code> and <code>gas</code>
 folders. We'll run a couple of analyses on the trajectories from the 
starting point of the simulation, the 'completely on' solvated structure
 of ethanol. Change into the relevant directory:</p>
<div class="sites-codeblock sites-codesnippet-block"><code>cd solution/ele1.0</code></div>
<p>Inside you'll find all the inputs we created in exercise 2, along with an <code>ethanol_run.arc</code> trajectory, <code>ethanol_run.dyn</code> restart file and <code>ethanol_run.out</code> output file. As a first basic use of <code>analyze</code>, lets check the input &amp; output structures for any unusual clashes. Run <code>analyze</code> on the input structure interactively:</p>
<div class="sites-codeblock sites-codesnippet-block"><code>analyze ethanol_run.xyz -k ethanol_run.key</code></div>
<p>You'll see a variety of options:</p>
<div class="sites-codeblock sites-codesnippet-block"><code>The TINKER Analysis Facility can Provide :</code><br>
<br>
<code>&nbsp;General System and Force Field Information [G]</code><br>
<code>&nbsp;Force Field Parameters for Interactions [P]</code><br>
<code>&nbsp;Total Potential Energy and its Components [E]</code><br>
<code>&nbsp;Energy Breakdown over Each of the Atoms [A]</code><br>
<code>&nbsp;List of the Large Individual Interactions [L]</code><br>
<code>&nbsp;Details for All Individual Interactions [D]</code><br>
<code>&nbsp;Electrostatic Moments and Principle Axes [M]</code><br>
<code>&nbsp;Internal Virial, dE/dV Values &amp; Pressure [V]</code><br>
<code>&nbsp;Connectivity Lists for Each of the Atoms [C]</code><br>
<br>
<code>&nbsp;Enter the Desired Analysis Types [G,P,E,A,L,D,M,V,C] :</code></div>
<p>Any of these options can be chosen individually or in combination 
with one another. In this case we'd like to check our file for any 
structural/energetic clashes. Choose option 'L', which will list any 
pairwise atomic interactions larger than a default 5 kcal/mol for bonded
 interactions, or 10 kcal/mol for nonbonded. As an output you should see
 one interaction listed, a vdW contact between a water hydrogen and 
adjacent water oxygen atom, with a distance of around 1.66<span style="background-color:transparent;font-size:10pt">
 Å. Although short, this is noting too unusual for a transient hydrogen 
bond. We'll perform the same analysis on the trajectory as a whole, 
redirecting the output to a new file:</span></p>
<div class="sites-codeblock sites-codesnippet-block"><code>analyze ethanol_run.arc -k ethanol_run.key l &amp;&gt; ethanol_large_interactions.out</code></div>
<p> </p>
<p>If you open the resulting <code>ethanol_large_interactions.out</code>
 file in a text editor and browse though, you'll see a few water-water 
contacts similar to that above, but nothing worry inducing. This, of 
course, is a fairly basic analysis of simulation stability but 
demonstrates how analyze can be performed on both single structures and a
 whole trajectory. Other Tinker-aware analysis packages are available, 
see side note 1.</p>
<div><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-on sites-embed" style="width:300px;"><h4 class="sites-embed-title">Side note 1 - Analysis packages</h4><div class="sites-embed-content sites-embed-type-text"><div class="sites-embed-content-textbox"><div dir="ltr">
<div style="text-align:center"><span style="color:rgb(255,0,0)">Beyond 
the programs available in Tinker, analysis of Tinker archive files can 
be performed in other packages too. The cpptraj program in <a target="_blank" href="https://web.archive.org/web/20210125225206/http://ambermd.org/" rel="nofollow">Amber</a> has a wealth of available analyses, the Python package <a target="_blank" href="https://web.archive.org/web/20210125225206/http://mdtraj.org/1.8.0/" rel="nofollow">MDTraj</a>
 will read Tinker archive files and can be used to manipulate sets of 
coordinates accordingly, and of course VMD may be used to visualise 
results and carry out other analyses. Many trajectory parsers only read 
the coordinate information, not the bonding information, from Tinker xyz
 files however, so a separate topology file may be needed to define how 
atoms are connected. For biomolecules this can often simply be a PDB, as
 amino acid residues have defined topology. You can create one using the
 Tinker <code>xyzpdb</code> program, for example.</span><br>
</div>
</div></div></div></div></div></div>
<p>Before we begin our BAR free energy calculation we'll check our simulations have been run with properly scaled parameters.<br>
</p>
<hr>
<h4><a name="TOC-Parameter-scaling-with-lambda"></a><span style="color:rgb(0,0,255)">Parameter scaling with lambda<br>
</span></h4>
<p>Let's check that we didn't make any typos in our inputs and that the 
parameters of ethanol have been properly scaled with lambda in our 
different simulations. Still in the ele1.0 folder, run analyze 
interactively on the input structure and choose option P:</p>
<div class="sites-codeblock sites-codesnippet-block" style="width:60%"><code>analyze ethanol_run.xyz -k ethanol_run.key</code></div>
<p>Choose option 'P' when prompted, and enter the atoms 1 to 9 for output, as these are the atoms in the ethanol molecule<b> (Remember:</b> you can select a range of atoms in Tinker by specifying the first number as negative, e.g. '<code>-1 9</code>'). All the atomic parameters will be printed to screen. Now, re-perform the same analysis using the key file used for the <b>next</b> lambda window:</p>
<div class="sites-codeblock sites-codesnippet-block" style="width:60%"><code>analyze ethanol_run.xyz -k ../ele0.9/ethanol_run.key</code></div>
<p>You should see how the multipole values and dipole polarisabilities 
(alpha) have been modified between the two simulations, and reduced to 
0.9 of their initial values. If you wish (and if there's time) you can 
perform the same analysis with one of the lambda windows for vdW 
decoupling, however, remember that<b> the decoupling step does not scale the raw parameters, instead it scales the solute-solvent interactions</b>.
 As such, you should check for differences in the vdW energy between key
 files, not the vdW parameters (radius &amp; epsilon) themselves.</p><p>Once you're happy to move on to the BAR analysis stage, carry on below.</p><hr><h2><a name="TOC-BAR-free-energy-estimates"></a>BAR free energy estimates</h2><h4><a name="TOC-Between-lambda-windows"></a><span style="color:rgb(0,0,255)">Between lambda windows</span></h4><p>We
 don't have time to delve deep into the theory of the calculations we're
 about to perform, but for those of you familiar with alchemical free 
energy calculations, the below equations should look familiar. For those
 of you who aren't, there are a number of excellent published reviews 
and introductions to the theory of free energy calculations, but the <a href="https://web.archive.org/web/20210125225206/http://www.alchemistry.org/wiki/Main_Page" target="_blank" rel="nofollow">Alchemistry wiki</a> is a good enough place to start. For today's purposes though, there are two main things to take from the below equations: <br></p><div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://web.archive.org/web/20210125225206/https://sites.google.com/site/amoebaworkshop/exercise-3/Free_energy_eqns.png?attredirects=0" imageanchor="1"><img border="0" height="216" src="Resources_files/Free_energy_eqns.png" width="320"></a></div><p>Namely, to evaluate the free energy difference between state <b><i>1</i></b> and state <b><i>0</i></b>, we need the potential energies at both states (<i><b>U<sub>1</sub></b></i>,<i><b>U<sub>0</sub></b></i>), evaluated over an ensemble average of structures from those states (<i><b>&lt;...&gt;<sub>0</sub></b></i>,<i><b>&lt;...&gt;<sub>1</sub></b></i>).
 It should be clear we already have the tools we need to do this - the 
key files for each lambda window describe the potential energy function 
for a given state, and the simulation structures represent the ensemble 
averages at each desired state. All we need is a program to evaluate the
 above expressions!</p><p>Fortunately, Tinker has this, in the shape of the bar program. Return to the <code>solution/ele1.0</code> directory we were analysing our simulations in above, and run the <code>bar</code> program interactively (as usual, just type <code>bar</code> on the command line). You'll be presented by a series of prompts that that will correspond to, in turn:</p><ol><li>The coordinate file of state <i><b>0</b></i> (<code>ethanol_run.arc</code>)</li><li>The frames of state <i><b>0</b> </i>you wish to analyse as part of the ensemble average (frames 1 to 200, at every step: <code>1 200 1</code>)</li><li>The temperature at state <i><b>0</b></i> (<code>300</code>)</li><li>The coordinate file of state <i><b>1</b></i> (<code>../ele0.9/ethanol_run.arc</code>)</li><li>The frames of state <i><b>1</b> </i>you wish to analyse as part of the ensemble average (frames 1 to 200, at every step: <code>1 200 1</code>)</li><li>The temperature at state <i><b>1</b></i> (<code>300</code>)</li></ol><p>Tinker automatically finds any key files with the same prefix as you use for the xyz files, so reads in <code>ethanol_run.arc</code> with <code>ethanol_run.key</code> and <code>../ele0.9/ethanol_run.arc</code> with <code>../ele_0.9/ethanol_run.key</code>.</p><p>Once
 you've entered all the inputs, after a few seconds you should see some 
results pop up. These are the forward &amp; backward FEP (i.e. 
exponential averaging) free energies, and the BAR free energy, between 
lambda windows 1.0 and 0.9 of the discharging step.</p><p>As you can 
imagine, running this interactively between every lambda window would be
 very time consuming, so instead we'll use a script for the rest of the 
free energy calculations.</p><h4><a name="TOC-Overall-hydration-free-energy"></a><span style="color:rgb(0,0,255)">Overall hydration free energy</span></h4><p>As a reminder, the thermodynamic cycle we use to divide the hydration free energy up into steps is as follows:</p><div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="./Resources/Therm_cycle_sfe.PNG?attredirects=0" imageanchor="1"><img border="0" height="234" src="./Resources/Therm_cycle_sfe.PNG" width="320"></a></div><p>This means that the overall hydration free energy, <span>ΔG<sub>sol</sub>, is given by:<br></span></p><p style="text-align:center"><span><font size="3"><b>ΔG<sub>sol</sub> = </b></font></span><font size="3"><b><span>ΔG<sub>discharging,vac</sub> - </span><span>ΔG<sub>decoupling,sol</sub> - </span><span>ΔG<sub>discharging,sol</sub></span></b></font></p><p style="text-align:left">A script has been prepared to run all of the bar analyses and write the results to separate files, and is available as <code>BAR_analysis.x</code> in the main <code>Exercise_3</code> directory. Submit this to Lyceum with:</p><div class="sites-codeblock sites-codesnippet-block"><code>qsub BAR_analysis.x</code></div><p style="text-align:left">It should take about 15 minutes to run, and if you want to see the underlying script, it's available as <code>run_bar.py</code>. It's very basic, and is just a loop over multiple calls of <code>bar</code>, e.g.:</p><div class="sites-codeblock sites-codesnippet-block"><p><code>bar ethanol_run.arc 1 200 1 300 ../ele0.9/ethanol_run.arc 1 200 1 300 &gt; sol_ele1.0-0.9_bar.out</code></p></div><p>
</p><p>Once complete, you'll have multiple files of the names "<code>[sol/gas]_[ele/vdw][lambda0]-[lambda1]_bar.out</code>",
 each of which contains free energy estimates calculated with 
FEP/exponential averaging, BAR and a re-estimation of the BAR free 
energy from bootstrapping the underlying ensemble. The free energy for 
the discharging/decoupling steps is simply the sum of the individual 
free energies for each of the lambda windows in that step, and the 
overall free energy of hydration can then be calculated from the 
equation above (be sure to get the signs correct!)</p><p>Try to have a go at this by extracting the data from the <code>bar</code> output files (hint, you may wish to <code>grep</code> or <code>awk</code> out the individual free energies and associated error bars into a more amenable format first, e.g.:</p><div class="sites-codeblock sites-codesnippet-block"><code>awk '/BAR\ Bootstrap\ Free\ Energy/ {print $5,$7}' sol_ele* &gt; sol_ele_energies.txt</code></div><p>Or if there's little time then summary files are available in the <code>outputs</code> folder. If you've summed the individual steps correctly then you should end up with a <span>ΔG<sub>sol</sub> of around -6.1 kcal/mol, compared with the <a href="http://pubs.acs.org/doi/full/10.1021/ct050097l" target="_blank" rel="nofollow">experimental value</a> of -5.0 kcal/mol, and a value<a href="http://pubs.acs.org/doi/abs/10.1021/ct800409d" target="_blank" rel="nofollow"> estimated with the GAFF fixed charge force field</a> of -3.45 kcal/mol.</span></p><p><span>While
 this agreement with experiment is good, it's not perfect, and may 
reflect the short simulation times and short equilibration times we've 
used here. If you wish to explore further then the length of the 
simulations would be a good place to start, as would the sensitivity of 
the free energies to <a href="http://pubs.acs.org/doi/abs/10.1021/acs.jctc.6b00276" target="_blank" rel="nofollow">small changes in parameterisation protocol</a>, or even <a href="http://onlinelibrary.wiley.com/doi/10.1002/jcc.21681/full" target="_blank" rel="nofollow">empirical scaling of the -OH group multipoles</a>.
 For now, though, we hope we've demonstrated a starting point of how to 
use AMOEBA, and Tinker, for some simple applications that are often of 
interest in biomolecular simulation.</span></p></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</tbody></table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://web.archive.org/web/20210125225206/https://accounts.google.com/ServiceLogin?continue=https://sites.google.com/site/amoebaworkshop/exercise-3&amp;service=jotspot">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="https://web.archive.org/web/20210125225206/https://sites.google.com/site/amoebaworkshop/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="https://web.archive.org/web/20210125225206/http://sites.google.com/site">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="Resources_files/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/site/amoebaworkshop/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("2bd", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_2bd');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//web.archive.org/web/20210125225206/https://docs.google.com/comments/d/AAHRpnXuj-DFPFSie3egVkMai3-ZO6Gs5cLLO9RJOtlNMavquagA__KQPBjT87qNeEsVXEvZFwrxBYLqzMx0wvNfsNSwPkoP5qHtCwiO2GwH0F1MbN71FyhuhtJCS9oYVwyWglDceyA97/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([1109635200000, 1128902400000, 1130657000000, 1143333000000, 1143806400000, 1145000000000, 1146380000000, 1152489600000, 1159800000000, 1159500000000, 1162095000000, 1162075000000, 1162105500000]);
    gsites.Xhr.send('https://web.archive.org/web/20210125225206/https://sites.google.com/site/amoebaworkshop/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://web.archive.org/web/20210125225206/https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<script type="text/javascript">
          sites.codeembed.init();
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>



</body></html>
<!--
     FILE ARCHIVED ON 22:52:06 Jan 25, 2021 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 23:21:32 Feb 13, 2024.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  exclusion.robots: 1.869 (7)
  exclusion.robots.policy: 1.74 (7)
  cdx.remote: 0.746 (7)
  esindex: 0.123 (7)
  LoadShardBlock: 1295.268 (24)
  PetaboxLoader3.datanode: 571.943 (26)
  load_resource: 182.815
  PetaboxLoader3.resolve: 113.691
  loaddict: 41.763
-->
