<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage"><head><script src="./Resources/analytics.js" type="text/javascript"></script><script src="./Resources/page-script.js" id="bw-fido2-page-script"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app28.us.archive.org';v.server_ms=404;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="./Resources/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="./Resources/wombat.js" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="./Resources/ruffle.js"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("https://sites.google.com./Exercise 2 part 1.html-part-2","20210125225206","https://web.archive.org/","web","https://web-static.archive.org/_static/",
	      "1611615126");
</script>
<link rel="stylesheet" type="text/css" href="./Resources/banner-styles.css">
<link rel="stylesheet" type="text/css" href="./Resources/iconochive.css">
<!-- End Wayback Rewrite JS Include -->

<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { /*

Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/
(function(){function e(g){this.t={};this.tick=function(h,k,f){this.t[h]=[void 0!=f?f:(new Date).getTime(),k];if(void 0==f)try{window.console.timeStamp("CSI/"+h)}catch(m){}};this.getStartTickTime=function(){return this.t.start[0]};this.tick("start",null,g)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var l=0<d?new e(d):new e;window.jstiming={Timer:e,load:l};if(a){var b=a.navigationStart;0<b&&d>=b&&(window.jstiming.srt=d-b)}if(a){var c=window.jstiming.load;0<b&&d>=
b&&(c.tick("_wtsrt",void 0,b),c.tick("wtsrt_","_wtsrt",d),c.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),c&&0<b&&(c.tick("_tbnd",void 0,window.chrome.csi().startE),c.tick("tbnd_","_tbnd",b))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,c&&0<b&&(c.tick("_tbnd",void 0,window.external.startE),c.tick("tbnd_","_tbnd",b))),a&&(window.jstiming.pt=a)}catch(g){}})(); })()
</script>
<link rel="shortcut icon" type="image/x-icon" href="https://web.archive.org/web/20210125225206im_/https://www.google.com/images/icons/product/sites-16.ico">
<link rel="apple-touch-icon" href="https://web.archive.org/web/20210125225206im_/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/images/apple-touch-icon.png" type="image/png">
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { function d(a){return document.getElementById(a)}window.byId=d;function g(a){return a.replace(/^\s+|\s+$/g,"")}window.trim=g;var h=[],k=0;window.JOT_addListener=function(a,b,c){var f=new String(k++);a={eventName:a,handler:b,compId:c,key:f};h.push(a);return f};window.JOT_removeListenerByKey=function(a){for(var b=0;b<h.length;b++)if(h[b].key==a){h.splice(b,1);break}};window.JOT_removeAllListenersForName=function(a){for(var b=0;b<h.length;b++)h[b].eventName==a&&h.splice(b,1)};
window.JOT_postEvent=function(a,b,c){var f={eventName:a,eventSrc:b||{},payload:c||{}};if(window.JOT_fullyLoaded)for(b=h.length,c=0;c<b&&c<h.length;c++){var e=h[c];e&&e.eventName==a&&(f.listenerCompId=e.compId||"",(e="function"==typeof e.handler?e.handler:window[e.handler])&&e(f))}else window.JOT_delayedEvents.push({eventName:a,eventSrc:b,payload:c})};window.JOT_delayedEvents=[];window.JOT_fullyLoaded=!1;
window.JOT_formatRelativeToNow=function(a,b){a=((new Date).getTime()-a)/6E4;if(1440<=a||0>a)return null;var c=0;60<=a&&(a/=60,c=2);2<=a&&c++;return b?window.JOT_siteRelTimeStrs[c].replace("__duration__",Math.floor(a)):window.JOT_userRelTimeStrs[c].replace("__duration__",Math.floor(a))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"./Exercise 2 part 1.html-part-2","deleted":false,"title":"Exercise 2 part 2 - Parameterising a new molecule (valence \u0026 vdW)","dir":"ltr"}];
  var JOT_clearDotPath = 'https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"gvizGstaticVersion":"current","enableAnalytics":false,"pageSharingId":"jotspot_page","codeembeds":{"outerIframeSrc":"https://web.archive.org/web/20210125225206/https://www.gstatic.com/jotspot/embeds/code/0f08d42392f2000e7e3f3daf5b427a43/outer_iframe.html","innerIframeSrc":"https://web.archive.org/web/20210125225206/https://1066218793-jotspot-embeds.googleusercontent.com/code/8d87fa64604b2a11fae2ed06104c58d3/inner_iframe.html"},"enableUniversalAnalytics":false,"sharingPolicy":"OPENED","siteTitle":"AMOEBA advanced potential energies workshop","jot2atari":{"eligibility":"ineligible"},"onepickUrl":"https://web.archive.org/web/20210125225206/https://docs.google.com/picker","adsensePublisherId":null,"features":{"moreMobileStyleImprovements":null,"subscriptionDataMigrationInProgress":null,"plusBadge":false},"isPublic":true,"newSitesBaseUrl":"https://web.archive.org/web/20210125225206/https://sites.google.com","isConsumer":true,"serverFlags":{"jot2AtariLearnMoreUrl":"https://web.archive.org/web/20210125225206/https://support.google.com/sites/answer/7035197"},"domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://web.archive.org/web/20210125225206/https://accounts.google.com/AccountChooser?continue\u003dhttps://sites.google.com./Exercise 2 part 1.html-part-2\u0026service\u003djotspot","analyticsAccountId":"","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://web.archive.org/web/20210125225206/https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//web.archive.org/web/20210125225206/https://www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/css/sitelayouteditor.css"],"text":["https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/js/codemirror.js","https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/css/codemirror_css.css","https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/js/trog_edit__en.js","https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/css/trogedit.css","/site/amoebaworkshop/_/rsrc/1610612676000/system/app/css/editor.css","https://web.archive.org/web/20210125225206/https://ssl.gstatic.com/sites/p/1cd7f2/system/app/css/codeeditor.css","/site/amoebaworkshop/_/rsrc/1610612676000/system/app/css/camelot/editor-jfk.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"defaultdomain","baseUri":"/site/amoebaworkshop","name":"amoebaworkshop","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":null,"parentWuid":null,"siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Exercise 2 part 2 - Parameterising a new molecule (valence \u0026 vdW)","locale":"en","wuid":"wuid:gx:13ed29ff4d31ec95","revision":20,"path":"/exercise-2-part-2","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"exercise-2-part-2","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","onePickToken":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/site/amoebaworkshop/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Exercise 2 part 2 - Parameterising a new molecule (valence &amp; vdW) - AMOEBA advanced potential energies workshop">
<meta itemprop="name" content="Exercise 2 part 2 - Parameterising a new molecule (valence &amp; vdW) - AMOEBA advanced potential energies workshop">
<meta property="og:title" content="Exercise 2 part 2 - Parameterising a new molecule (valence &amp; vdW) - AMOEBA advanced potential energies workshop">
<meta name="description" content="Instructions and activities for the AMOEBA advanced potentials workshop, Southampton, Dec 2016">
<meta itemprop="description" content="Instructions and activities for the AMOEBA advanced potentials workshop, Southampton, Dec 2016">
<meta id="meta-tag-description" property="og:description" content="Instructions and activities for the AMOEBA advanced potentials workshop, Southampton, Dec 2016">
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="./Resources/standard-css-simple-ltr-ltr.css">
<link rel="stylesheet" type="text/css" href="./Resources/overlay.css">
<link rel="stylesheet" type="text/css" href="./Resources/allthemes-view.css">
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/site/amoebaworkshop/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Exercise 2 part 2 - Parameterising a new molecule (valence &amp; vdW) - AMOEBA advanced potential energies workshop</title>
<meta itemprop="image" content="https://web.archive.org/web/20210125225206im_/https://sites.google.com/site/amoebaworkshop/_/rsrc/1480003294336/exercise-2-part-2/ethanol_minimisation.png?height=293&amp;width=320">
<meta property="og:image" content="https://web.archive.org/web/20210125225206im_/https://sites.google.com/site/amoebaworkshop/_/rsrc/1480003294336/exercise-2-part-2/ethanol_minimisation.png?height=293&amp;width=320">
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
<script type="text/javascript" charset="UTF-8" src="./Resources/platform.js"></script></head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            "><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;">
</div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20210125225206/https://sites.google.com./Exercise 2 part 1.html-part-2</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(725,27,25,2,"web","https://sites.google.com./Exercise 2 part 1.html-part-2","20210125225206",1996,"https://web-static.archive.org/_static/",["https://web-static.archive.org/_static/css/banner-styles.css?v=S1zqJCYt","https://web-static.archive.org/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="">
<tbody><tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><h2><a href="./Home.html" dir="ltr" id="sites-chrome-userheader-title">AMOEBA advanced potential energies workshop</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="./Home.html" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site"><input type="text" id="jot-ui-searchInput" name="q" size="20" aria-label="Search this site"><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0" style="user-select: none;">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</tbody></table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tbody><tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2bd" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Navigation</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotid="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="./Home.html" jotid="wuid:gx:2433b5dc13050779" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="./Intro & setup.html" jotid="wuid:gx:1fd6c32ac2b1a6fe" class="sites-navigation-link">Intro &amp; setup</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="./Exercise 1.html" jotid="wuid:gx:45351533ca1c2014" class="sites-navigation-link">Exercise 1 - Getting started with Tinker</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="./Exercise 2 part 1.html" jotid="wuid:gx:bd56be6b29c141c" class="sites-navigation-link">Exercise 2 part 1 - Parameterising a new molecule (electrostatics)</a></div></li><li class=""><div class="current-bg" jotid="wuid:gx:13ed29ff4d31ec95" dir="ltr" style="padding-left: 5px;">Exercise 2 part 2 - Parameterising a new molecule (valence &amp; vdW)</div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="./Exercise 3.html" jotid="wuid:gx:6bf20198ee7a45b8" class="sites-navigation-link">Exercise 3 - Analysing trajectories and calculating free energies</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="./Sitemap.html" jotid="wuid:gx:66aafe7b737940d1" class="sites-navigation-link">Sitemap</a></div></li></ul></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
</div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Exercise 2 part 2 - Parameterising a new molecule (valence &amp; vdW)</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Remaining-parameter-setup-and-free-energy-calculations"><strong>1 </strong>Remaining parameter setup and free energy calculations</a></li><li class="goog-toc"><a href="#TOC-The-valence-program"><strong>2 </strong>The valence program</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Assigning-some-initial-parameters"><strong>2.1 </strong>Assigning some initial parameters</a></li><li class="goog-toc"><a href="#TOC-Parameter-validation---minimisation"><strong>2.2 </strong>Parameter validation - minimisation</a></li></ol></li><li class="goog-toc"><a href="#TOC-Setting-up-a-solvation-free-energy-calculation"><strong>3 </strong>Setting up a solvation free energy calculation</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Solvating-our-system"><strong>3.1 </strong>Solvating our system</a></li><li class="goog-toc"><a href="#TOC-Minimising-and-equilibrating"><strong>3.2 </strong>Minimising and equilibrating</a></li><li class="goog-toc"><a href="#TOC-Solvation-free-energy-setup"><strong>3.3 </strong>Solvation free energy setup</a></li></ol></li></ol></div></div></div></div></div><br><h2><a name="TOC-Remaining-parameter-setup-and-free-energy-calculations"></a>Remaining parameter setup and free energy calculations<br></h2><p>Assigning
 valence parameters in AMOEBA (bonds, angles, stretch-bends, 
out-of-plane bends, torsions &amp; vdW parameters) is similar to the 
process used in other force fields. There are a few potential options:</p><div><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-on sites-embed" style="width:300px;"><h4 class="sites-embed-title">Side note 1 - Atom types vs atom classes</h4><div class="sites-embed-content sites-embed-type-text"><div class="sites-embed-content-textbox"><div dir="ltr"><div style="text-align:center"><span style="color:rgb(255,0,0)">If
 you remember the layout of our AMOEBA prm file from our electrostatics 
parameterisation, there were a few lines beginning 'atom' at the top of 
the file, e.g.:</span><br><code>atom&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 401&nbsp; 401&nbsp;&nbsp;&nbsp; C&nbsp;&nbsp;&nbsp;&nbsp; "ethanol"<br></code></div><div style="text-align:center"><span style="color:rgb(255,0,0)">The second and third column, here containing <code>401</code>,
 define the atom type and atom class respectively. Atom types are used 
for electrostatics parameters - each unique set of 
multipoles/polarisabilities should have a unique atom type. Atom classes
 are used for valence &amp; vdW parameters - multiple different atom 
types may have the same atom class and hence the same 
bonds/angles/dihedral parameters or vdW sigma/epsilon values.</span><br></div></div></div></div></div></div></div><ul><li>Assign by similarity to existing parameters</li><li>Derive new parameters directly from QM data</li><li>A mixture of the two (e.g. by refining an initial set of parameters with a QM torsional energy profile)</li></ul><p>Valence
 parameters in AMOEBA are defined by atom class (see side note 1 for the
 difference between atom class and atom type), and a variety of atom 
classes already exist for organic molecules (see <code>amoeba09.prm</code> in the Tinker <code>params</code> folder) or proteins (see <code>amoebapro13.prm</code>). If you wish to use these, they can be sourced in your simulations <i>via</i>
 the use of the parameters keyword at the top of your key file. If 
you've defined new atom classes, or if you wish to refine these 
parameters further, the Tinker <code>valence</code> program is the way to go.</p><hr><h2><a name="TOC-The-valence-program"></a>The <code>valence</code> program<br></h2><h4><a name="TOC-Assigning-some-initial-parameters"></a><span style="color:rgb(0,0,255)">Assigning some initial parameters</span></h4><p>Let's continue in the <code>Exercise_2</code>
 folder in which we've created our AMOEBA prm file with a final set of 
multipoles and other electrostatic parameters. However, to keep things 
tidy we'll start with fresh filenames:</p><div class="sites-codeblock sites-codesnippet-block"><code>cp ethanol_renumbered.xyz ethanol_valence.xyz</code><br><code>cp AMOEBA_ethanol_postfit.prm AMOEBA_ethanol_valence.prm</code></div><p>Next, run the <code>valence</code> program interactively (just type <code>valence</code> on the command line) and you'll see four options:</p><div class="sites-codeblock sites-codesnippet-block"><code>&nbsp;The TINKER Valence Parameter Facility Can :</code><br><br><code>&nbsp;&nbsp;&nbsp; (1) Set Initial Values for Valence Parameters</code><br><code>&nbsp;&nbsp;&nbsp; (2) Compare QM and MM Vibrational Frequencies</code><br><code>&nbsp;&nbsp;&nbsp; (3) Force Fit of Parameters to QM Results</code><br><code>&nbsp;&nbsp;&nbsp; (4) Structure Fit of Parameters to QM Results</code></div><p>Today we'll only be using option 1, as ethanol is a fairly simple molecule, but as you can see <code>valence</code>
 can also be used to refine bond/angle parameters more tightly to 
recreate QM data. Option 3 minimises AMOEBA forces for a given QM 
structure, and option 4 minimises the structural difference between QM 
&amp; MM minimum structures.</p><p>Choose option 1 and follow the instructions on screen, using the <code>ethanol_valence.xyz</code> set of coordinates, the<code> ethanol_esp.log</code> Gaussian output file and the <code>AMOEBA_ethanol_valence.prm</code>
 set of input parameters. Valence prints out a set of estimated vdW and 
bonded parameters to screen for you. Frustratingly they're not printed 
to file! You may wish to re-run the program non-interactively and 
redirect output to a new file, e.g.:</p><div class="sites-codeblock sites-codesnippet-block"><code>valence 1 ethanol_valence.xyz ethanol_esp.log AMOEBA_ethanol_valence.prm &gt; valence_estimates.txt</code></div><p>Add the vdW, bond, angle, stretch-bend and torsional parameters to the <code>AMOEBA_ethanol_valence.prm</code>
 file and your parameterisation of ethanol is complete. For more 
complicated small molecules than ethanol one should check that the 
torsional parameters accurately represent molecular energetics as a bond
 rotates - the Tinker torsfit program can be used to fit torsions to QM 
data, for example. For now, though, we'll use the suggested torsional 
parameters for ethanol and perform some basic simulations with our 
molecule to validate the parameters.<br></p><hr><h4><a name="TOC-Parameter-validation---minimisation"></a><span style="color:rgb(0,0,255)">Parameter validation - minimisation</span></h4>Comparing
 the MM and QM minimised structures is a simple way to ensure our newly 
assigned parameters don't distort the molecular geometry or move too far
 from the local QM minimum. Create a new key file containing options to 
run a minimisation similarly to exercise 1, e.g.:<br><div class="sites-codeblock sites-codesnippet-block"><code>parameters AMOEBA_ethanol_valence.prm</code><br><br><code>openmp-threads 1</code><br><br><code>cutoff 999.0</code><br><code>polar-eps 0.00001</code><br><br><code>neighbor-list</code><br><br><code>maxiter 2000</code><br><code>printout 100</code></div><p>Run this minimisation on the login node - it's extremely quick so we don't need to submit a job to Lyceum:</p><div class="sites-codeblock sites-codesnippet-block"><code>minimize ethanol_valence.xyz -k ethanol_min.key 0.01</code></div><p>You
 can copy the resulting file, ethanol_valence.xyz_2, back to your local 
desktop using WinSCP and open it in VMD. If you copy the initial 
structure, ethanol_valence.xyz, back too and compare it with the final 
structure they should look something like this:</p><div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://web.archive.org/web/20210125225206/https://sites.google.com./Exercise 2 part 1.html-part-2/ethanol_minimisation.png?attredirects=0" imageanchor="1"><img border="0" height="293" src="./Resources/ethanol_minimisation.png" width="320"></a></div><p>Where
 the initial structure is in blue, and the final in red. As you can see,
 there is little difference between the MM and QM minima, which 
hopefully suggests a high degree of confidence in using these parameters
 for simulations. We will test this in the next step.</p><hr><h2><a name="TOC-Setting-up-a-solvation-free-energy-calculation"></a>Setting up a solvation free energy calculation</h2><h4><a name="TOC-Solvating-our-system"></a><span style="color:rgb(0,0,255)">Solvating our system</span></h4><p>To
 run a solvation free energy calculation we'll first need to solvate and
 equilibrate our system in a box of water molecules. AMOEBA uses a 
3-site fully flexible water model, so in theory we could use any 
pre-equilibrated box of 3-site waters for this, but Tinker comes 
packaged with water boxes of a variety of sizes, so we will use one of 
those instead (you'll find it in your folder, called <code>waterbox.xyz</code>. As the header describes, this is a cubic box of side length 24.662 A). We'll use the program <code>xyzedit</code> to facilitate this. Run <code>xyzedit</code> with the minimised ethanol structure and key file:</p><div class="sites-codeblock sites-codesnippet-block"><code>xyzedit ethanol_minimised.xyz -k ethanol_min.key</code></div><p>You'll see a huge range of options:</p><div class="sites-codeblock sites-codesnippet-block"><code>&nbsp;The TINKER XYZ Editing Facility can Provide :</code><br><br><code>&nbsp;&nbsp;&nbsp; (1) Offset the Numbers of the Current Atoms</code><br><code>&nbsp;&nbsp;&nbsp; (2) Deletion of Individual Specified Atoms</code><br><code>&nbsp;&nbsp;&nbsp; (3) Deletion of Specified Types of Atoms</code><br><code>&nbsp;&nbsp;&nbsp; (4) Deletion of Atoms outside Cutoff Range</code><br><code>&nbsp;&nbsp;&nbsp; (5) Insertion of Individual Specified Atoms</code><br><code>&nbsp;&nbsp;&nbsp; (6) Replace Old Atom Type with a New Type</code><br><code>&nbsp;&nbsp;&nbsp; (7) Assign Connectivities for Linear Chain</code><br><code>&nbsp;&nbsp;&nbsp; (8) Assign Connectivities based on Distance</code><br><code>&nbsp;&nbsp;&nbsp; (9) Convert Units from Bohrs to Angstroms</code><br><code>&nbsp;&nbsp; (10) Invert thru Origin to give Mirror Image</code><br><code>&nbsp;&nbsp; (11) Translate All Atoms by an X,Y,Z-Vector</code><br><code>&nbsp;&nbsp; (12) Translate Center of Mass to the Origin</code><br><code>&nbsp;&nbsp; (13) Translate a Specified Atom to the Origin</code><br><code>&nbsp;&nbsp; (14) Translate and Rotate to Inertial Frame</code><br><code>&nbsp;&nbsp; (15) Move to Specified Rigid Body Coordinates</code><br><code>&nbsp;&nbsp; (16) Move Stray Molecules into Periodic Box</code><br><code>&nbsp;&nbsp; (17) Delete Molecules outside of Periodic Box</code><br><code>&nbsp;&nbsp; (18) Append a Second XYZ File to Current One</code><br><code>&nbsp;&nbsp; (19) Create and Fill a Periodic Boundary Box</code><br><code>&nbsp;&nbsp; (20) Soak Current Molecule in Box of Solvent</code></div><p>First
 choose option 12, then choose option 20, which will centre and solvate 
your system, automatically deleting any water molecules that overlap 
with the solute. When prompted after selecting option 20, enter the name
 of the solvent box (<code>waterbox.xyz</code>) and take note of the new filename that has been written out - rename this to something more sensible, e.g.:</p><div class="sites-codeblock sites-codesnippet-block"><code>mv ethanol_minimised.xyz_2 ethanol_solv.xyz</code></div><p>If
 you wish, you can copy the solvated system back to your local desktop 
and visualise it in VMD to check it has been solvated correctly - you 
should see something like this:</p><div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://web.archive.org/web/20210125225206/https://sites.google.com./Exercise 2 part 1.html-part-2/ethanol_solv.png?attredirects=0" imageanchor="1"><img border="0" height="304" src="./Resources/ethanol_solv.png" width="320"></a></div><p>Once
 happy the solvated system looks sensible you can move on to the next 
stage, in which we'll minimise and equilibrate the system as a whole, 
ready for input to a solvation free energy calculation.<br></p><hr><h4><a name="TOC-Minimising-and-equilibrating"></a><font color="#0000ff">Minimising and equilibrating</font></h4><p>Minimising
 and equilibrating the system will be performed using a similar protocol
 to that we used in Exercise 1. First, however, we'll have to combine 
our ethanol parameters with some water parameters in our prm file:</p><div class="sites-codeblock sites-codesnippet-block"><code>cp AMOEBA_ethanol_valence.prm AMOEBA_ethanol_solv.prm &amp;&amp; cat outputs/water03.prm &gt;&gt; AMOEBA_ethanol_solv.prm</code></div><p>The <code>water03.prm</code> file in the outputs folder is an edited version of that available in the Tinker <code>params</code> folder, with the usual AMOEBA header of force field options deleted as we already have these in our <code>AMOEBA_ethanol_valence.prm</code> file.</p><p><span style="background-color:transparent;font-size:10pt">You
 may use the key files from Exercise 1 as a guide for preparing your own
 (remember you'll need to update the periodic box dimensions to the 
correct size for our system here - a cubic box of sides 24.662 A, and 
source our ethanol+water parameters at the top of the file using the </span><code style="font-size:10pt">parameters</code><span style="background-color:transparent;font-size:10pt"> keyword), or you can find suitable inputs available as </span><code style="font-size:10pt">ethanol_solv_min.key</code><span style="background-color:transparent;font-size:10pt">, </span><code style="font-size:10pt">ethanol_solv_nvt.key</code><span style="background-color:transparent;font-size:10pt"> and </span><code>ethanol_solv_npt.key</code> in the <code>outputs</code> folder<span style="background-color:transparent;font-size:10pt">.&nbsp;</span></p><p>A
 script to submit the minimisation and equilibration to Lyceum is 
available, which will run each MD simulation for a total of 10 ps. 
Submit this with:</p><div class="sites-codeblock sites-codesnippet-block"><code>qsub Equilibrations.x</code></div><p>This
 should take around 15-20 minutes to run, so you may wish to grab a 
coffee during this time. Alternatively, if time is tight, feel free to 
reduce the length of the simulations by modifying <code>Equilibrations.x</code>.</p><p>Once
 the simulations are complete, you can look at the output files to check
 temperature &amp; pressure have equilibrated (these simulations are 
quite short, so don't worry if they're not completely equilibrated yet),
 and/or copy the trajectory files back to your local machine to 
visualise them in VMD.</p><p>As a final step in this exercise, we'll use
 our final equilibrated system as the starting point for our solvation 
free energy calculations.<br></p><hr><h4><a name="TOC-Solvation-free-energy-setup"></a><font color="#0000ff">Solvation free energy setup</font></h4><div><p>As a reminder, we'll be recreating the thermodynamic cycle below:</p><div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://web.archive.org/web/20210125225206/https://sites.google.com./Exercise 2 part 1.html-part-2/Therm_cycle_sfe.PNG?attredirects=0" imageanchor="1"><img border="0" height="292" src="./Resources/Therm_cycle_sfe.PNG" width="400"></a></div><p>As such, we'll have to set up simulations that describe the transformations <b>a -&gt; c</b> and <b>b -&gt; d</b>,
 i.e. a removal of charges on the solute in both solution phase and gas 
phase, and a vdW decoupling of the solute from its environment in the 
solution phase only (in the gas phase there is no environment, so the 
free energy of decoupling is necessarily zero!). For choice of number of
 intermediates/lambda window spacing we will follow a <a href="http://onlinelibrary.wiley.com/doi/10.1002/jcc.21681/full" target="_blank" rel="nofollow">variety</a> of <a href="http://pubs.acs.org/doi/abs/10.1021/acs.jctc.6b00276" target="_blank" rel="nofollow">published</a> <a href="http://onlinelibrary.wiley.com/doi/10.1002/jcc.24500/full" target="_blank" rel="nofollow">studies</a> and use linear spacing for the discharging step and non-linear spacing for the vdW decoupling:</p><ul><li>Lambda windows for electrostatics = 1.0, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1, 0.0</li><li>Lambda windows for vdW = 1.0, 0.9, 0.8, 0.75, 0.7, 0.65, 0.6, 0.5, 0.4, 0.2, 0.0<br></li></ul><p>Tinker
 has a simple functionality for absolute free energy calculations, 
including softcore vdW treatment of appearing or disappearing atoms, 
controlled by specifying a few keywords in the key file:</p><div class="sites-codeblock sites-codesnippet-block"><code>ligand -1 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Definition of atoms </code><code>to be mutated (negative first number defines a range)</code><br><code>ele-lambda 0.9</code><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 # Lambda value for scaling electrostatic interactions (1.0 = on, 0.0 = 
off)</code><br><code>vdw-lambda 
1.0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # 
Lambda value for scaling vdW interactions (1.0 = on, 0.0 = off)<br></code></div><p>Adding
 the above lines to a key file scales the multipoles and 
polarisabilities on atoms 1-9 (inclusive) by 0.9, but keeps the vdW 
interactions completely unperturbed. We therefore need to create a 
separate key file for each different lambda value, in solution phase and
 gas phase. To do this by hand would be a laborious process, so we'll 
use a basic script to do this for us:</p><div class="sites-codeblock sites-codesnippet-block"><code>./create_ele_vdw.x</code></div><p>Provided
 you've used the default filenames we've suggested for everything 
throughout (if not, try to make some edits to the script), this should 
create two folders, <code>solution</code> and <code>gas</code>, 
containing subfolders for each lambda window and everything needed to 
run the simulations. Take a look around and notice how the <code>ele-lambda</code> and <code>vdw-lambda</code> keywords change for each simulation. Also note we're using a far tighter convergence on our induced dipoles (<code>polar-eps 0.00001</code>) as tightly converged dipoles will improve the accuracy &amp; precision of free energy differences between states.</p><p>These
 simulations are all ready to run. However, each lambda window (in 
solution phase) will take somewhere around 12-14 hours, so we won't 
start them today. Instead, in the next exercise we'll use an example set
 of trajectories to perform a BAR free energy analysis.<br></p></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</tbody></table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://web.archive.org/web/20210125225206/https://accounts.google.com/ServiceLogin?continue=https://sites.google.com./Exercise 2 part 1.html-part-2&amp;service=jotspot">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="https://web.archive.org/web/20210125225206/https://sites.google.com/site/amoebaworkshop/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="https://web.archive.org/web/20210125225206/http://sites.google.com/site">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="./Resources/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/site/amoebaworkshop/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("2bd", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_2bd');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//web.archive.org/web/20210125225206/https://docs.google.com/comments/d/AAHRpnXuj-DFPFSie3egVkMai3-ZO6Gs5cLLO9RJOtlNMavquagZDt4BsDeHpGFynUp0qcUb56VHqqltRBypqWZJvRaQc27c9vJTuKyRAJfK3XoDHJLmgUBJ2A0m0rE1oh2HRiqbtrY83/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([1109635200000, 1128902400000, 1130657000000, 1143333000000, 1143806400000, 1145000000000, 1146380000000, 1152489600000, 1159800000000, 1159500000000, 1162095000000, 1162075000000, 1162105500000]);
    gsites.Xhr.send('https://web.archive.org/web/20210125225206/https://sites.google.com/site/amoebaworkshop/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://web.archive.org/web/20210125225206/https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<script type="text/javascript">
          sites.codeembed.init();
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>



</body></html>
<!--
     FILE ARCHIVED ON 22:52:06 Jan 25, 2021 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 00:07:15 Feb 14, 2024.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  exclusion.robots: 2.03 (7)
  exclusion.robots.policy: 1.891 (7)
  cdx.remote: 1.27 (7)
  esindex: 0.113 (7)
  LoadShardBlock: 1003.778 (24)
  PetaboxLoader3.datanode: 809.132 (26)
  load_resource: 183.934
  PetaboxLoader3.resolve: 108.577
  loaddict: 44.059
-->
